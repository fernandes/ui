<div class="container py-8">
  <div class="space-y-8">
    <h1 class="text-4xl font-bold">Dialog</h1>
    <p class="text-muted-foreground">
      A window overlaid on either the primary window or another dialog window, rendering the content underneath inert.
    </p>

    <% if defined?(Phlex) %>
    <!-- Default Dialog -->
    <div class="space-y-4">
      <h2 class="text-2xl font-semibold">Default</h2>
      <p class="text-muted-foreground text-sm">
        A basic dialog with form fields. Uses default button trigger (without asChild).
      </p>

      <%= render UI::Dialog::Dialog.new(open: false, close_on_escape: true, close_on_overlay_click: true, attributes: { id: "default-dialog" }) do %>
        <%= render UI::Dialog::Trigger.new do %>
          Edit Profile
        <% end %>

        <%= render UI::Dialog::Overlay.new(open: false) do %>
          <%= render UI::Dialog::Content.new(classes: "sm:max-w-[425px]") do %>
            <%= render UI::Dialog::Header.new do %>
              <%= render UI::Dialog::Title.new do %>
                Edit profile
              <% end %>
              <%= render UI::Dialog::Description.new do %>
                Make changes to your profile here. Click save when you're done.
              <% end %>
            <% end %>

            <div class="grid gap-4 py-4">
              <div class="grid grid-cols-4 items-center gap-4">
                <label for="name" class="text-right text-sm font-medium">Name</label>
                <input id="name" type="text" value="Pedro Duarte" class="col-span-3 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm shadow-xs transition-all file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50" />
              </div>
              <div class="grid grid-cols-4 items-center gap-4">
                <label for="username" class="text-right text-sm font-medium">Username</label>
                <input id="username" type="text" value="@peduarte" class="col-span-3 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm shadow-xs transition-all file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50" />
              </div>
            </div>

            <%= render UI::Dialog::Footer.new do %>
              <%= render UI::Dialog::Close.new(variant: :default) do %>
                Save changes
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    </div>

    <!-- asChild Composition -->
    <div class="space-y-4">
      <h2 class="text-2xl font-semibold">Composition with asChild</h2>
      <p class="text-muted-foreground text-sm">
        Using <code class="px-1 py-0.5 rounded bg-muted text-sm">as_child: true</code> to compose with custom Button component. No wrapper div!
      </p>

      <%= render UI::Dialog::Dialog.new(open: false, attributes: { id: "aschild-dialog" }) do %>
        <%= render UI::Dialog::Trigger.new(as_child: true) do |trigger_attrs| %>
          <%= render UI::Button::Button.new(**trigger_attrs, variant: :outline) do %>
            Open with asChild
          <% end %>
        <% end %>

        <%= render UI::Dialog::Overlay.new(open: false) do %>
          <%= render UI::Dialog::Content.new do %>
            <%= render UI::Dialog::Header.new do %>
              <%= render UI::Dialog::Title.new do %>
                asChild Composition
              <% end %>
              <%= render UI::Dialog::Description.new do %>
                This dialog was opened using asChild composition. The trigger button has no wrapper element - Stimulus attributes were merged directly into the Button component!
              <% end %>
            <% end %>

            <div class="py-4">
              <p class="text-sm">Inspect the DOM and you'll see the trigger button has <code class="px-1 py-0.5 rounded bg-muted text-xs">data-action="click->ui--dialog#open"</code> merged with Button's classes, all in a single element.</p>
            </div>

            <%= render UI::Dialog::Footer.new do %>
              <%= render UI::Dialog::Close.new do %>
                Got it!
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    </div>

    <!-- Custom Width Dialog -->
    <div class="space-y-4">
      <h2 class="text-2xl font-semibold">Custom Width</h2>
      <p class="text-muted-foreground text-sm">
        You can customize the width of the dialog using Tailwind classes.
      </p>

      <%= render UI::Dialog::Dialog.new(open: false) do %>
        <%= render UI::Dialog::Trigger.new(as_child: true) do |trigger_attrs| %>
          <%= render UI::Button::Button.new(**trigger_attrs, variant: :outline) do %>
            View Details
          <% end %>
        <% end %>

        <%= render UI::Dialog::Overlay.new(open: false) do %>
          <%= render UI::Dialog::Content.new(classes: "sm:max-w-[725px]") do %>
            <%= render UI::Dialog::Header.new do %>
              <%= render UI::Dialog::Title.new do %>
                Share this document
              <% end %>
              <%= render UI::Dialog::Description.new do %>
                Anyone with the link can view this document.
              <% end %>
            <% end %>

            <div class="space-y-4 py-4">
              <div class="space-y-2">
                <label class="text-sm font-medium">Link</label>
                <div class="flex items-center gap-2">
                  <input type="text" value="https://ui.shadcn.com/docs/installation" readonly class="flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm" />
                  <%= render UI::Button::Button.new(variant: :outline, size: :sm) do %>
                    Copy
                  <% end %>
                </div>
              </div>
            </div>

            <%= render UI::Dialog::Footer.new do %>
              <%= render UI::Dialog::Close.new do %>
                Close
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    </div>

    <!-- No Overlay Click Dialog -->
    <div class="space-y-4">
      <h2 class="text-2xl font-semibold">Prevent Outside Click</h2>
      <p class="text-muted-foreground text-sm">
        This dialog only closes via the close button or Escape key.
      </p>

      <%= render UI::Dialog::Dialog.new(open: false, close_on_overlay_click: false, attributes: { id: "no-overlay-dialog" }) do %>
        <%= render UI::Button::Button.new(variant: :destructive, data: { action: "click->ui--dialog#open" }) do %>
          Delete Account
        <% end %>

        <%= render UI::Dialog::Overlay.new(open: false) do %>
          <%= render UI::Dialog::Content.new do %>
            <%= render UI::Dialog::Header.new do %>
              <%= render UI::Dialog::Title.new do %>
                Are you sure?
              <% end %>
              <%= render UI::Dialog::Description.new do %>
                This action cannot be undone. You must explicitly confirm or cancel.
              <% end %>
            <% end %>

            <%= render UI::Dialog::Footer.new do %>
              <%= render UI::Dialog::Close.new(variant: :outline) do %>
                Cancel
              <% end %>
              <%= render UI::Dialog::Close.new(variant: :destructive) do %>
                Delete
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    </div>
    <% end %>

    <!-- ERB Section -->
    <div class="border-t pt-8 mt-8">
      <h2 class="text-3xl font-bold mb-6">ERB Partials</h2>
      <p class="text-muted-foreground mb-8">
        Dialog components using ERB partial rendering with <code class="px-1 py-0.5 rounded bg-muted text-sm">render "ui/dialog/..."</code>
      </p>

      <!-- ERB Default Dialog -->
      <div class="space-y-4">
        <h3 class="text-2xl font-semibold">ERB Default</h3>
        <p class="text-muted-foreground text-sm">
          A basic dialog using ERB partials.
        </p>

        <%= render "ui/dialog/dialog", attributes: { id: "erb-default-dialog" } do %>
          <%= render "ui/dialog/trigger" do %>
            Open ERB Dialog
          <% end %>

          <%= render "ui/dialog/overlay" do %>
            <%= render "ui/dialog/content", classes: "sm:max-w-[425px]" do %>
              <%= render "ui/dialog/header" do %>
                <%= render "ui/dialog/title" do %>
                  ERB Dialog
                <% end %>
                <%= render "ui/dialog/description" do %>
                  This dialog is rendered using ERB partials.
                <% end %>
              <% end %>

              <div class="grid gap-4 py-4">
                <div class="grid grid-cols-4 items-center gap-4">
                  <label for="erb-name" class="text-right text-sm font-medium">Name</label>
                  <input id="erb-name" type="text" value="Jane Doe" class="col-span-3 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm shadow-xs transition-all placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-[3px] focus-visible:ring-ring/50" />
                </div>
              </div>

              <%= render "ui/dialog/footer" do %>
                <%= render "ui/dialog/close", variant: :default do %>
                  Save
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      </div>

      <!-- ERB asChild Dialog -->
      <div class="space-y-4 mt-8">
        <h3 class="text-2xl font-semibold">ERB with asChild</h3>
        <p class="text-muted-foreground text-sm">
          Using <code class="px-1 py-0.5 rounded bg-muted text-sm">as_child: true</code> with ERB partials.
        </p>

        <%= render "ui/dialog/dialog", attributes: { id: "erb-aschild-dialog" }, close_on_overlay_click: false do %>
          <%= render "ui/dialog/trigger", as_child: true do |attrs| %>
            <%= render "ui/button/button", variant: :outline, attributes: attrs do %>
              Open with asChild (ERB)
            <% end %>
          <% end %>

          <%= render "ui/dialog/overlay" do %>
            <%= render "ui/dialog/content" do %>
              <%= render "ui/dialog/header" do %>
                <%= render "ui/dialog/title" do %>
                  asChild Composition (ERB)
                <% end %>
                <%= render "ui/dialog/description" do %>
                  This dialog trigger uses the asChild pattern with ERB partials.
                <% end %>
              <% end %>

              <div class="py-4">
                <p class="text-sm">The trigger button received its attributes via the yielded block parameter.</p>
              </div>

              <%= render "ui/dialog/footer" do %>
                <%= render "ui/dialog/close", as_child: true do |attrs| %>
                  <%= render "ui/button/button", variant: :outline, attributes: attrs do %>
                    Close (asChild)
                  <% end %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>

    <% if defined?(ViewComponent) %>
    <!-- ViewComponent Section -->
    <div class="border-t pt-8 mt-8">
      <h2 class="text-3xl font-bold mb-6">ViewComponents</h2>
      <p class="text-muted-foreground mb-8">
        Dialog components using ViewComponent rendering with <code class="px-1 py-0.5 rounded bg-muted text-sm">UI::Dialog::*Component</code>
      </p>

      <!-- ViewComponent Default Dialog -->
      <div class="space-y-4">
        <h3 class="text-2xl font-semibold">ViewComponent Default</h3>
        <p class="text-muted-foreground text-sm">
          A basic dialog using ViewComponents.
        </p>

        <%= render UI::Dialog::DialogComponent.new do %>
          <%= render UI::Dialog::TriggerComponent.new do %>
            Open VC Dialog
          <% end %>

          <%= render UI::Dialog::OverlayComponent.new do %>
            <%= render UI::Dialog::ContentComponent.new(classes: "sm:max-w-[425px]") do %>
              <%= render UI::Dialog::HeaderComponent.new do %>
                <%= render UI::Dialog::TitleComponent.new do %>
                  ViewComponent Dialog
                <% end %>
                <%= render UI::Dialog::DescriptionComponent.new do %>
                  This dialog is rendered using ViewComponents.
                <% end %>
              <% end %>

              <div class="grid gap-4 py-4">
                <div class="grid grid-cols-4 items-center gap-4">
                  <label for="vc-name" class="text-right text-sm font-medium">Name</label>
                  <input id="vc-name" type="text" value="John Smith" class="col-span-3 flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-sm shadow-xs transition-all placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-[3px] focus-visible:ring-ring/50" />
                </div>
              </div>

              <%= render UI::Dialog::FooterComponent.new do %>
                <%= render UI::Dialog::CloseComponent.new(variant: :default) do %>
                  Save
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      </div>

      <!-- ViewComponent asChild Dialog -->
      <div class="space-y-4 mt-8">
        <h3 class="text-2xl font-semibold">ViewComponent with asChild</h3>
        <p class="text-muted-foreground text-sm">
          Using <code class="px-1 py-0.5 rounded bg-muted text-sm">as_child: true</code> with ViewComponents (Nokogiri pattern - no block params needed).
        </p>

        <%= render UI::Dialog::DialogComponent.new do %>
          <%= render UI::Dialog::TriggerComponent.new(as_child: true) do %>
            <%= render UI::Button::ButtonComponent.new(variant: :outline) do %>
              Open with asChild (VC)
            <% end %>
          <% end %>

          <%= render UI::Dialog::OverlayComponent.new do %>
            <%= render UI::Dialog::ContentComponent.new do %>
              <%= render UI::Dialog::HeaderComponent.new do %>
                <%= render UI::Dialog::TitleComponent.new do %>
                  asChild Composition (ViewComponent)
                <% end %>
                <%= render UI::Dialog::DescriptionComponent.new do %>
                  ViewComponent uses Nokogiri to inject attributes - no block parameter needed!
                <% end %>
              <% end %>

              <div class="py-4">
                <p class="text-sm">ViewComponent parses the rendered HTML and injects data attributes into the first child element automatically.</p>
              </div>

              <%= render UI::Dialog::FooterComponent.new do %>
                <%= render UI::Dialog::CloseComponent.new(as_child: true) do %>
                  <%= render UI::Button::ButtonComponent.new(variant: :outline) do %>
                    Close (asChild)
                  <% end %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
    <% end %>
  </div>
</div>
